Исходный код на си с небольшими правками взят отсюда:

http://acm.mipt.ru/twiki/bin/view/Curriculum/FIVTLecturesTerm1Lecture6
